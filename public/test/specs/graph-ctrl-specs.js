/*! grafana - v2.6.0 - 2015-12-14
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["./helpers","app/features/panel/panel_srv","app/features/panel/panel_helper","app/panels/graph/module"],function(a){"use strict";describe("GraphCtrl",function(){var b=new a.ControllerTestContext;beforeEach(module("grafana.services")),beforeEach(module("grafana.panels.graph")),beforeEach(b.providePhase()),beforeEach(b.createControllerPhase("GraphCtrl")),describe("get_data with 2 series",function(){beforeEach(function(){b.annotationsSrv.getAnnotations=sinon.stub().returns(b.$q.when([])),b.datasource.query=sinon.stub().returns(b.$q.when({data:[{target:"test.cpu1",datapoints:[[1,10]]},{target:"test.cpu2",datapoints:[[1,10]]}]})),b.scope.render=sinon.spy(),b.scope.refreshData(b.datasource),b.scope.$digest()}),it("should send time series to render",function(){var a=b.scope.render.getCall(0).args[0];expect(a.length).to.be(2)}),describe("get_data failure following success",function(){beforeEach(function(){b.datasource.query=sinon.stub().returns(b.$q.reject("Datasource Error")),b.scope.refreshData(b.datasource),b.scope.$digest()})})})})});