/*! grafana - v4.0.0-1478693311beta1 - 2016-11-09
 * Copyright (c) 2016 Torkel Ã–degaard; Licensed Apache-2.0 */

System.register(["app/core/utils/kbn","./variable"],function(a){var b,c,d;return{setters:[function(a){b=a},function(a){c=a}],execute:function(){d=function(){function a(a,b,d){this.model=a,this.datasourceSrv=b,this.variableSrv=d,this.defaults={type:"datasource",name:"",hide:0,label:"",current:{},regex:"",options:[],query:"",refresh:1},c.assignModelProperties(this,a,this.defaults),this.refresh=1}return a.$inject=["model","datasourceSrv","variableSrv"],a.prototype.getModel=function(){return c.assignModelProperties(this.model,this,this.defaults),this.model},a.prototype.setValue=function(a){return this.variableSrv.setOptionAsCurrent(this,a)},a.prototype.updateOptions=function(){var a,c=[],d=this.datasourceSrv.getMetricSources({skipVariables:!0});this.regex&&(a=b["default"].stringToJsRegex(this.regex));for(var e=0;e<d.length;e++){var f=d[e];f.meta.id===this.query&&(a&&!a.exec(f.name)||c.push({text:f.name,value:f.name}))}return 0===c.length&&c.push({text:"No data sources found",value:""}),this.options=c,this.variableSrv.validateVariableSelectionState(this)},a.prototype.dependsOn=function(a){return!1},a.prototype.setValueFromUrl=function(a){return this.variableSrv.setOptionFromUrl(this,a)},a.prototype.getValueForUrl=function(){return this.current.value},a}(),a("DatasourceVariable",d),c.variableTypes.datasource={name:"Datasource",ctor:d,description:"Enabled you to dynamically switch the datasource for multiple panels"}}}});