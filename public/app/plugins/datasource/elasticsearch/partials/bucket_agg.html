<div class="gf-form-inline"><div class="gf-form"><label class="gf-form-label query-keyword width-7"><span ng-show="isFirst">Group by</span> <span ng-hide="isFirst">Then by</span></label><metric-segment-model property="agg.type" options="bucketAggTypes" on-change="onTypeChanged()" custom="false" css-class="width-10"></metric-segment-model><metric-segment-model ng-if="agg.field" property="agg.field" get-options="getFieldsInternal()" on-change="onChange()" css-class="width-12"></metric-segment-model></div><div class="gf-form gf-form--grow"><label class="gf-form-label gf-form-label--grow"><a ng-click="toggleOptions()"><i class="fa fa-caret-down" ng-show="showOptions"></i> <i class="fa fa-caret-right" ng-hide="showOptions"></i> {{settingsLinkText}}</a></label></div><div class="gf-form"><label class="gf-form-label" ng-if="isFirst"><a class="pointer" ng-click="addBucketAgg()"><i class="fa fa-plus"></i></a></label><label class="gf-form-label"><a class="pointer" ng-click="removeBucketAgg()"><i class="fa fa-minus"></i></a></label></div></div><div class="gf-form-group" ng-if="showOptions"><div ng-if="agg.type === 'date_histogram'"><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Interval</label><metric-segment-model property="agg.settings.interval" get-options="getIntervalOptions()" on-change="onChangeInternal()" css-class="width-12" custom="true"></metric-segment-model></div><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Min Doc Count</label><input type="number" class="gf-form-input max-width-12" ng-model="agg.settings.min_doc_count" ng-blur="onChangeInternal()"></div><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Trim edges<info-popover mode="right-normal">Trim the edges on the timeseries datapoints</info-popover></label><input class="gf-form-input max-width-12" type="number" ng-model="agg.settings.trimEdges" ng-change="onChangeInternal()"></div></div><div ng-if="agg.type === 'terms'"><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Order</label><metric-segment-model property="agg.settings.order" options="orderOptions" on-change="onChangeInternal()" css-class="width-12"></metric-segment-model></div><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Size</label><metric-segment-model property="agg.settings.size" options="sizeOptions" on-change="onChangeInternal()" css-class="width-12"></metric-segment-model></div><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Order By</label><metric-segment-model property="agg.settings.orderBy" options="orderByOptions" on-change="onChangeInternal()" css-class="width-12"></metric-segment-model></div></div><div ng-if="agg.type === 'filters'"><div class="gf-form-inline offset-width-7" ng-repeat="filter in agg.settings.filters"><div class="gf-form"><label class="gf-form-label width-10">Query {{$index + 1}}</label><input type="text" class="gf-form-input max-width-12" ng-model="filter.query" spellcheck="false" placeholder="Lucene query" ng-blur="onChangeInternal()"></div><div class="gf-form"><label class="gf-form-label" ng-if="$first"><a class="pointer" ng-click="addFiltersQuery()"><i class="fa fa-plus"></i></a></label><label class="gf-form-label" ng-if="!$first"><a class="pointer" ng-click="removeFiltersQuery(filter)"><i class="fa fa-minus"></i></a></label></div></div></div><div ng-if="agg.type === 'geohash_grid'"><div class="gf-form offset-width-7"><label class="gf-form-label width-10">Precision</label><input type="number" class="gf-form-input max-width-12" ng-model="agg.settings.precision" spellcheck="false" placeholder="3" ng-blur="onChangeInternal()"></div></div></div>