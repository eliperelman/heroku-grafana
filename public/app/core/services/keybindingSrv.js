/*! grafana - v4.0.0-1478693311beta1 - 2016-11-09
 * Copyright (c) 2016 Torkel Ã–degaard; Licensed Apache-2.0 */

System.register(["jquery","lodash","app/core/core_module","app/core/app_events","mousetrap"],function(a){var b,c,d,e,f,g;return{setters:[function(a){b=a},function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(){function a(a,b,c,d,e){var g=this;this.$rootScope=a,this.$modal=b,this.$location=c,this.contextSrv=d,this.$timeout=e,a.$on("$routeChangeSuccess",function(){f["default"].reset(),g.setupGlobal()}),this.setupGlobal()}return a.$inject=["$rootScope","$modal","$location","contextSrv","$timeout"],a.prototype.setupGlobal=function(){this.bind(["?","h"],this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("s s",this.openSearchStarred),this.bind("s o",this.openSearch),this.bind("s t",this.openSearchTags),this.bind("f",this.openSearch)},a.prototype.openSearchStarred=function(){this.$rootScope.appEvent("show-dash-search",{starred:!0})},a.prototype.openSearchTags=function(){this.$rootScope.appEvent("show-dash-search",{tagsMode:!0})},a.prototype.openSearch=function(){this.$rootScope.appEvent("show-dash-search")},a.prototype.openAlerting=function(){this.$location.url("/alerting")},a.prototype.goToHome=function(){this.$location.url("/")},a.prototype.goToProfile=function(){this.$location.url("/profile")},a.prototype.showHelpModal=function(){e["default"].emit("show-modal",{templateHtml:"<help-modal></help-modal>"})},a.prototype.bind=function(a,b){var c=this;f["default"].bind(a,function(a){return a.preventDefault(),a.stopPropagation(),a.returnValue=!1,c.$rootScope.$apply(b.bind(c))})},a.prototype.showDashEditView=function(a){var b=c["default"].extend(this.$location.search(),{editview:a});this.$location.search(b)},a.prototype.setupDashboardBindings=function(a,c){var d=this;this.bind("mod+o",function(){c.sharedCrosshair=!c.sharedCrosshair,a.broadcastRefresh()}),this.bind("mod+h",function(){c.hideControls=!c.hideControls}),this.bind("mod+s",function(b){a.appEvent("save-dashboard")}),this.bind("t z",function(){a.appEvent("zoom-out")}),this.bind("t left",function(){a.appEvent("shift-time-backward")}),this.bind("t right",function(){a.appEvent("shift-time-forward")}),this.bind("mod+i",function(){a.appEvent("quick-snapshot")}),this.bind("e",function(){c.meta.focusPanelId&&c.meta.canEdit&&d.$rootScope.appEvent("panel-change-view",{fullscreen:!0,edit:!0,panelId:c.meta.focusPanelId,toggle:!0})}),this.bind("v",function(){c.meta.focusPanelId&&d.$rootScope.appEvent("panel-change-view",{fullscreen:!0,edit:null,panelId:c.meta.focusPanelId,toggle:!0})}),this.bind("p r",function(){if(c.meta.focusPanelId&&c.meta.canEdit){var a=c.getPanelInfoById(c.meta.focusPanelId);a.row.removePanel(a.panel),c.meta.focusPanelId=0}}),this.bind("p s",function(){if(c.meta.focusPanelId){var b=a.$new(),d=c.getPanelInfoById(c.meta.focusPanelId);b.panel=d.panel,b.dashboard=c,e["default"].emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:b})}}),this.bind("r r",function(){if(c.meta.focusPanelId&&c.meta.canEdit){var a=c.getPanelInfoById(c.meta.focusPanelId);c.removeRow(a.row),c.meta.focusPanelId=0}}),this.bind("r c",function(){if(c.meta.focusPanelId){var a=c.getPanelInfoById(c.meta.focusPanelId);a.row.toggleCollapse(),c.meta.focusPanelId=0}}),this.bind("d r",function(){a.broadcastRefresh()}),this.bind("d s",function(){d.showDashEditView("settings")}),this.bind("d k",function(){e["default"].emit("toggle-kiosk-mode")}),this.bind("d v",function(){e["default"].emit("toggle-view-mode")}),this.bind("esc",function(){var c=b["default"](".popover.in");if(!(c.length>0)){var d=b["default"](".modal").data();d&&d.$scope&&d.$scope.dismiss&&d.$scope.dismiss(),a.appEvent("hide-dash-editor"),a.exitFullscreen()}})},a}(),a("KeybindingSrv",g),d["default"].service("keybindingSrv",g)}}});